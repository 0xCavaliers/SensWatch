è¿™æ˜¯ä¸€ä¸ªå…³é”®è®¾è®¡é—®é¢˜ï¼Œæˆ‘ä»¬å¯ä»¥ä»ä»¥ä¸‹å‡ ä¸ªæ–¹é¢æ¥åˆ¶å®šåè®®/æ¡†æ¶é€‰æ‹©ï¼Œç¡®ä¿æ»¡è¶³ä½ æå‡ºçš„åŠŸèƒ½éœ€æ±‚ï¼ŒåŒæ—¶å…·å¤‡**æ€§èƒ½ã€æ‰©å±•æ€§ã€è·¨å¹³å°é€‚é…èƒ½åŠ›**ã€‚

------

## âœ… é€šä¿¡åè®®é€‰æ‹©å»ºè®®

| åœºæ™¯                           | åè®®å»ºè®®                           | åŸå›                                                    |
| ------------------------------ | ---------------------------------- | ------------------------------------------------------ |
| **å¿ƒè·³ / ç­–ç•¥åŒæ­¥ / ä¸Šçº¿é€šçŸ¥** | **HTTP(S) + RESTful API**          | æ˜“äºå®ç°ï¼Œé˜²ç«å¢™å‹å¥½ï¼Œè°ƒè¯•ç®€å•ï¼Œé€‚åˆå¿ƒè·³è½®è¯¢å’Œç­–ç•¥æ‹‰å– |
| **æ–‡ä»¶å˜æ›´äº‹ä»¶ä¸ŠæŠ¥**           | **HTTP(S) POST**                   | æ•°æ®åŒ…ç»“æ„åŒ–ä¸ŠæŠ¥ï¼Œå®¹æ˜“æ‰©å±•ä¸å­˜æ¡£                       |
| **ç­–ç•¥å˜æ›´ä¸»åŠ¨æ¨é€ï¼ˆå¯é€‰ï¼‰**   | **WebSocket / Server-Sent Events** | å®æ—¶æ¨é€æ–°ç­–ç•¥ï¼Œå‡å°‘å®¢æˆ·ç«¯é¢‘ç¹è½®è¯¢å‹åŠ›ï¼ˆå¯é€‰é¡¹ï¼‰       |
| **æ–­ç”µ/æ–­ç½‘æ¢å¤åŒæ­¥**          | **HTTP é‡è¿è¡¥ä¼ ï¼ˆå¸¦ç¼“å­˜ï¼‰**        | ç¦»çº¿ç¼“å­˜ + æ¢å¤åŒæ­¥æœºåˆ¶æ›´ç¨³å¥                          |



------

## âœ… æŠ€æœ¯æ¡†æ¶é€‰æ‹©å»ºè®®ï¼ˆå®¢æˆ·ç«¯ + ç®¡ç†ä¸­å¿ƒï¼‰

### ğŸ–¥ï¸ å®¢æˆ·ç«¯æ¨èæ¡†æ¶

| æŠ€æœ¯                       | ç”¨é€”               | æ¨èåŸå›                                    |
| -------------------------- | ------------------ | ------------------------------------------ |
| **Go + fsnotify**          | æ–‡ä»¶å˜åŒ–ç›‘å¬       | åŸç”Ÿæ”¯æŒ Windowsï¼Œäº¤å‰ç¼–è¯‘ç®€å•ï¼Œå ç”¨èµ„æºå° |
| **HTTP clientï¼ˆGo å†…å»ºï¼‰** | å¿ƒè·³ + ç­–ç•¥æ‹‰å–    | æ˜“ç”¨ç¨³å®šï¼ŒGo æ ‡å‡†åº“ç›´æ¥æ”¯æŒ                |
| **SQLite**                 | æœ¬åœ°ç¼“å­˜           | è·¨å¹³å°ï¼Œé€‚åˆæœ¬åœ°è½»é‡è®°å½•                   |
| **gRPCï¼ˆå¯é€‰ï¼‰**           | åç»­ä¼˜åŒ–ä¸ºå®æ—¶é€šè®¯ | æ€§èƒ½ä¼˜ï¼ŒäºŒè¿›åˆ¶ä¼ è¾“æ›´å¿«ï¼Œä½†å¼€å‘æˆæœ¬ç•¥é«˜     |



> ğŸ”§ å¯é€‰è¯­è¨€ï¼šPythonï¼ˆå¿«é€Ÿå¼€å‘ï¼‰ï¼Œä½†åœ¨éƒ¨ç½²åˆ°å¤šä¸ª Windows å®¢æˆ·ç«¯ä¸Šå»ºè®®æœ€ç»ˆä½¿ç”¨ Go æ„å»º `.exe`ï¼Œéƒ¨ç½²ç®€å•ä¸”ä¾èµ–å°‘ã€‚

------

### ğŸ§  ç®¡ç†ä¸­å¿ƒæ¨èæ¡†æ¶

| æŠ€æœ¯                         | ç”¨é€”                              | æ¨èåŸå›                      |
| ---------------------------- | --------------------------------- | ---------------------------- |
| **FastAPI (Python)**         | æä¾› REST APIã€ç­–ç•¥æœåŠ¡ã€å¿ƒè·³å¤„ç† | æ”¯æŒå¼‚æ­¥ã€æ€§èƒ½ä¼˜ï¼Œå¼€å‘å¿«é€Ÿ   |
| **Flask (Python)**           | è½»é‡ç®¡ç†ä¸­å¿ƒåŸå‹å¼€å‘              | å°å‹é¡¹ç›®è¶³å¤Ÿç”¨ï¼Œæ˜“éƒ¨ç½²       |
| **Redis / MySQL / SQLite**   | å­˜å‚¨ç­–ç•¥/çŠ¶æ€/æ•æ„Ÿè®°å½•            | å–å†³äºé›†ç¾¤è§„æ¨¡å’Œè®°å½•éœ€æ±‚     |
| **WebSocket (FastAPI æ”¯æŒ)** | ç­–ç•¥å®æ—¶æ¨é€                      | å¯é€‰æ¨¡å—ï¼Œå¢å¼ºä½“éªŒï¼Œä¸å¼ºä¾èµ– |



------

## ğŸ”Œ ç¤ºä¾‹æ¥å£è®¾è®¡ï¼ˆRESTfulï¼‰

### å®¢æˆ·ç«¯å¿ƒè·³

```
http


å¤åˆ¶ç¼–è¾‘
POST /api/heartbeat
Body:
{
  "uuid": "client-001",
  "version": "1.0.0",
  "status": "online",
  "current_strategy_version": "v2.1"
}
```

### ç­–ç•¥æ‹‰å–

```
http


å¤åˆ¶ç¼–è¾‘
GET /api/strategy?uuid=client-001
Response:
{
  "strategy_version": "v2.2",
  "rules": [...],
  "update_required": true
}
```

### æ•æ„Ÿæ–‡ä»¶å˜æ›´ä¸ŠæŠ¥

```
http


å¤åˆ¶ç¼–è¾‘
POST /api/file-event
Body:
{
  "uuid": "client-001",
  "event_type": "modify",
  "file_path": "C:/Documents/secret.docx",
  "rule_hit": ["R001"],
  "timestamp": "2025-06-05T10:00:00Z"
}
```

------

## âœ… é¡¹ç›®åˆ†å±‚ç»“æ„å»ºè®®

### å®¢æˆ·ç«¯ï¼ˆGoï¼‰

```
bash


å¤åˆ¶ç¼–è¾‘
client/
â”œâ”€â”€ main.go                  # å®¢æˆ·ç«¯ä¸»å…¥å£
â”œâ”€â”€ watcher.go               # fsnotify æ–‡ä»¶ç›‘æ§
â”œâ”€â”€ heartbeat.go             # å¿ƒè·³ä»»åŠ¡è°ƒåº¦å™¨
â”œâ”€â”€ strategy_sync.go         # ç­–ç•¥åŒæ­¥å™¨
â”œâ”€â”€ event_reporter.go        # æ•æ„Ÿæ–‡ä»¶ä¸ŠæŠ¥é€»è¾‘
â”œâ”€â”€ cache.db                 # SQLite æœ¬åœ°ç¼“å­˜
â””â”€â”€ config.yaml              # å®¢æˆ·ç«¯é…ç½®
```

### ç®¡ç†ä¸­å¿ƒï¼ˆFastAPIï¼‰

```
bash


å¤åˆ¶ç¼–è¾‘
server/
â”œâ”€â”€ main.py                  # FastAPI å¯åŠ¨å™¨
â”œâ”€â”€ routes/
â”‚   â”œâ”€â”€ heartbeat.py         # å¿ƒè·³ä¸ä¸Šçº¿é€šçŸ¥æ¥å£
â”‚   â”œâ”€â”€ strategy.py          # ç­–ç•¥åˆ†å‘æ¥å£
â”‚   â””â”€â”€ event.py             # æ•æ„Ÿæ–‡ä»¶å˜æ›´ä¸ŠæŠ¥æ¥å£
â”œâ”€â”€ models/
â”‚   â””â”€â”€ schema.py            # æ•°æ®ç»“æ„å®šä¹‰
â”œâ”€â”€ storage/
â”‚   â”œâ”€â”€ redis.py             # å®¢æˆ·çŠ¶æ€ç®¡ç†
â”‚   â””â”€â”€ mysql.py             # ç­–ç•¥å’Œå†å²è®°å½•å­˜å‚¨
â””â”€â”€ config.yaml
```

------

## âœ… éƒ¨ç½²å»ºè®®

| ç»„ä»¶     | å»ºè®®éƒ¨ç½²æ–¹å¼                                                 |
| -------- | ------------------------------------------------------------ |
| ç®¡ç†ä¸­å¿ƒ | Linux Server + FastAPI + Nginxï¼ˆå¯æ”¯æŒ HTTPSï¼‰               |
| å®¢æˆ·ç«¯   | ç¼–è¯‘æˆ Windows å¯æ‰§è¡Œç¨‹åºï¼ˆGo ç¼–è¯‘æˆ .exeï¼‰ï¼Œæ”¯æŒæ‰˜ç›˜å¯åŠ¨ã€å¼€æœºè‡ªå¯ç­‰ |
| ç½‘ç»œé€šä¿¡ | é»˜è®¤ä½¿ç”¨ HTTP/HTTPS ç«¯å£ï¼Œé¿å…é˜²ç«å¢™é—®é¢˜ï¼Œå¯åŠ ç­¾åè®¤è¯æˆ– JWT |