# 客户端-服务器心跳检测系统

这是一个基于 Go 和 Python 实现的客户端-服务器心跳检测系统，用于监控客户端在线状态。

## 系统架构

### 服务器端 (Python)
- 使用 Flask 框架实现 RESTful API
- 提供客户端注册、心跳检测、状态查询等功能
- 支持多客户端并发连接
- 实现了简单的 API 密钥认证机制

### 客户端 (Go)
- 实现了自动注册、心跳发送、状态查询等功能
- 支持优雅退出（信号处理）
- 实现了请求重试机制
- 使用 HTTP 长连接保持通信

## 功能特性

- 客户端自动注册
- 定期心跳检测（15秒间隔）
- 客户端状态监控
- API 密钥认证
- 优雅退出处理
- 请求重试机制
- 实时状态显示

## 快速开始

### 服务器端启动

```bash
python hop_s.py
```

服务器将在 `0.0.0.0:5000` 启动，提供以下 API 接口：
- POST `/api/register` - 客户端注册
- POST `/api/heartbeat` - 心跳检测
- POST `/api/unregister` - 客户端注销
- GET `/api/status` - 状态查询

### 客户端启动

```bash
go run hop_c.go
```
```bash
go run hop_c1.go
```
```bash
go run hop_c2.go
```

客户端将：
1. 自动注册到服务器
2. 每15秒发送一次心跳
3. 每30秒查询一次状态
4. 在收到终止信号时自动注销

## 配置说明

### 服务器配置
- API 密钥: `secure-api-key-123`
- 心跳超时时间: 30秒
- 状态检查间隔: 10秒

### 客户端配置
- 服务器地址: `http://localhost:5000/api`
- API 密钥: `secure-api-key-123`
- 心跳频率: 15秒
- 客户端 IP: `192.168.1.100`（可配置）

## 注意事项

1. 确保服务器和客户端使用相同的 API 密钥
2. 客户端 IP 地址需要根据实际环境配置
3. 服务器需要开放 5000 端口
4. 建议在生产环境中使用 HTTPS 进行通信

## 开发环境

- Python 3.x
- Go 1.x
- Flask
- 标准库依赖 